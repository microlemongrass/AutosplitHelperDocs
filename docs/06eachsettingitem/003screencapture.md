---
title: Screen Capture
weight: 3
bookToc: false
---

# Screen Capture

{{<hint info>}}
キャプチャ方式をScreenにした場合、この項目を設定する必要があります。
{{</hint>}}

{{< figure src="/image/ash/setscreencapture001.png" class="center" >}}

### キャプチャタイプ
ウィンドウキャプチャ/Windows Graphics Capture/デスクトップキャプチャ（スクリーンを直接キャプチャ）から選択できます。

タイプを選択し、下のリストからキャプチャしたいウィンドウを選択し、「キャプチャ範囲初期化」を押すことで指定したウィンドウをキャプチャできます。

　
#### タイプ:Window
いわゆるウィンドウキャプチャです。\
選択方法は、リストからキャプチャしたいウィンドウを選択する、Selectを押してキャプチャしたいウィンドウを選択する、の2通りです。\
どちらかの方法でウィンドウを選択した後、「キャプチャ範囲初期化」を押すことでウィンドウ全体がキャプチャ範囲になります。初回指定時は必ず押してください。

{{<hint info>}}
2回目以降、もしウィンドウの再選択が必要となった時、「キャプチャ範囲初期化」を押さずにいることで、以前と同じ範囲をキャプチャできます。
{{</hint>}}

#### タイプ:WGC
Windows Graphics Captureを使用してキャプチャします。使用方法はタイプ:Windowと同様です。

{{<hint warning>}}
Windows10 2004以降でのみ使用可能です。
{{</hint>}}
　
#### タイプ:Desktop
デスクトップキャプチャです。ウィンドウキャプチャ/Windows Graphics Captureが使用できない場合に使用してください。\
キャプチャ範囲の指定方法はウィンドウキャプチャと同様です（Selectを使用した指定はしないほうが良いかもしれません）。

※「追従する」にチェックを入れることで、選択したウィンドウの移動を感知し、追従します。クロッピングの調整を行う前に指定してください。\
\
\
ASH上で実際に監視などの処理をするときの解像度は「表示解像度」で指定できます。スクリーンキャプチャを行い、クロッピングを行ったあとの映像が、ここで指定した解像度にリサイズされます。

{{<hint info>}}
キャプチャするウィンドウのサイズ、表示解像度が小さいほどPCへの負荷が少なくなります。例えばキャプチャソフトを選択する場合、キャプチャソフトのウィンドウサイズをあらかじめ小さくしておくと良いでしょう。
{{</hint>}}

{{<hint info>}}
ウィンドウキャプチャを使用すると、キャプチャするウィンドウを移動したり、他のウィンドウの後ろに隠れてもキャプチャすることができます。しかし、一部のウィンドウはキャプチャすることができません（ハードウェアアクセラレーションが有効なアプリケーション等）。
{{</hint>}}

{{<hint info>}}
ウィンドウキャプチャでキャプチャできないウィンドウは、Windows Graphics Captureもしくはデスクトップキャプチャを使用することでキャプチャできます。\
\
Windows Graphics Captureはほとんど全てのウィンドウをキャプチャすることができますが、負荷が大きくなります。
{{</hint>}}

  Type         | Window   | WGC     | Desktop
---------------|----------|---------|---------
  キャプチャできるウィンドウ | 限られる | ほぼ全て| 全て
  対象ウィンドウが他のウィンドウで隠れた場合 | キャプチャできる | キャプチャできる| キャプチャできない
  フレームレート | 最大約63fps | モニターのリフレッシュレートと同値| 最大約30fps
  フレーム落ち | 必ず発生する | 発生しにくい（スペックに依存？）| 必ず発生する
  負荷 | 小さい | 大きい| 大きい

　
### Select
ハードウェアアクセラレーションが無効のアプリケーションの場合であっても、正常にキャプチャできないことがあります（アマレコTV4等）。その場合、「Select」でキャプチャしたいウィンドウを指定するとキャプチャできることがあります。

　
### クロッピング
キャプチャした映像に黒帯など消したい部分がある場合、「設定、プレビュー」からクロップ範囲の指定をすることで、該当部分を消去することができます。

{{< figure src="/image/ash/setscreencapture002.png" class="center" >}}


{{<hint info>}}
- ウィンドウキャプチャの場合、ウィンドウの左上の座標が(0, 0)になります。
- デスクトップキャプチャの場合、デスクトップの左上の座標が(0, 0)になります。

- クロッピング枠内にある「16:xxx」はクロップ後のアスペクト比です。ゲームのアスペクト比と合うようにクロップを行うと良いかもしれません。
{{</hint>}}

{{<hint warning>}}
- キャプチャサイズが大きい場合、キャプチャ速度に時間がかかるためフレームレートが低下します（60fpsの維持は最大でも1280x720程度）
- デスクトップキャプチャを使用する場合は更にフレームレートが低下します（最大30~34fps）。
  
高精度に監視を行いたい場合はVirtual Captureを使用してください。
{{</hint>}}
